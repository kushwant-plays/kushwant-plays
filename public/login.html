<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Login — Kushwant Plays Admin</title>
  <link rel="icon" href="assets/playslogo.png">
  <style>
    body{margin:0;font-family:Poppins,system-ui,Arial;background:#0b0b0b;color:#fff;display:grid;place-items:center;height:100vh}
    .card{width:360px;padding:28px;border-radius:14px;background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.05);text-align:center}
    h1{color:#ff4747;margin-bottom:12px}
    .btn{display:inline-flex;align-items:center;gap:10px;padding:12px 16px;border-radius:10px;border:none;cursor:pointer;font-weight:600}
    .google{background:linear-gradient(90deg,#ff4747,#cc0000);color:#fff;width:100%}
    .note{color:#bbb;margin-top:10px;font-size:13px}
  </style>
</head>
<body>
  <div class="card">
    <h1>Kushwant Plays — Admin</h1>
    <p class="note">Sign in with your Google account (admin only)</p>
    <button id="googleSignIn" class="btn google" title="Sign in with Google">
      <img src="https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/google.svg" width="20" alt=""> Sign in with Google
    </button>
    <p class="note" id="status"></p>
  </div>

  <script type="module">
    import { auth } from "./scripts/firebase-init.js";
    import { GoogleAuthProvider, signInWithPopup, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/12.5.0/firebase-auth.js";

    const provider = new GoogleAuthProvider();
    const btn = document.getElementById("googleSignIn");
    const status = document.getElementById("status");

    btn.addEventListener("click", async () => {
      try {
        status.textContent = "Opening Google sign-in...";
        const result = await signInWithPopup(auth, provider);
        const user = result.user;
        if (user.email !== "prady346@gmail.com") {
          status.textContent = "Access denied for " + user.email;
          // sign them out immediately
          await auth.signOut();
          return;
        }
        // success -> redirect
        window.location.href = "dashboard.html";
      } catch (err) {
        console.error(err);
        status.textContent = "Sign-in failed: " + (err.message || err.code || "unknown");
      }
    });

    // If already signed in and authorized, go directly to dashboard
    onAuthStateChanged(auth, user => {
      if (user && user.email === "prady346@gmail.com") {
        window.location.href = "dashboard.html";
      }
    });
  </script>
</body>
</html>
